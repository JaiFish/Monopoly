{"version":3,"sources":["assets\\Script\\Class\\Panel_Map.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import AssetMng from \"../Asset/AssetMng\";\r\nimport { GameEvent } from \"../Enum/GameEvent\";\r\nimport { StationType } from \"../Enum/StationType\";\r\nimport { TypeClass } from \"../Enum/TypeClass\";\r\nimport MapItem from \"../Item/MapItem\";\r\nimport ComponentBase from \"../Data/base/ComponentBase\";\r\nimport MapSprite from \"../Item/MapSprite\";\r\nimport GameModle from \"../GameModle\";\r\n\r\nexport default class Panel_Map extends ComponentBase {\r\n    public tempMapItem: cc.Node;\r\n    public content_Map: cc.Node;\r\n    public content_Station: cc.Node;\r\n    public content_Station2: cc.Node;\r\n    exceptionArray: number[] = [8, 12, 13, 18, 19]\r\n    protected onLoad(): void {\r\n        this.tempMapItem = cc.find(\"mapItem\", this.node)\r\n        this.content_Map = cc.find(\"nContent_Map\", this.node)\r\n        this.content_Station = cc.find(\"nContent_StationSprite\", this.node)\r\n        this.content_Station2 = cc.find(\"Canvas/Panel_Map2/nContent_StationSprite\")\r\n        this.initEvent(GameEvent.InitMap, this.initMap)\r\n    }\r\n    protected start(): void {\r\n\r\n    }\r\n    async initMap(_path: cc.Animation) {\r\n\r\n        let pathData: Array<object> = _path.getClips()[0].curveData.props.position\r\n        //拿取Animation的路徑\r\n        for (let index: number = 0; index < pathData.length; index++) {\r\n            let x: number = pathData[index][\"value\"][0]\r\n            let y: number = pathData[index][\"value\"][1]\r\n\r\n            GameModle.pathPositionData.set(index, cc.v2(x, y))\r\n            // console.log(pathData[index]);\r\n            if (pathData[index][\"motionPath\"] != null && pathData[index][\"motionPath\"].length > 0) { //檢查是否有Bezier\r\n                this.AddBezier(index, pathData, GameModle);\r\n            }\r\n        }\r\n        //生產地圖的點\r\n        await AssetMng.checkState();\r\n        for (let index = 0; index < pathData.length - 1; index++) {//原點跟終點都是一樣的點，內容依樣就不用新增\r\n            let tempItem: cc.Node = cc.instantiate(this.tempMapItem)\r\n            this.content_Map.addChild(tempItem, cc.macro.MAX_ZINDEX)\r\n            tempItem.setPosition(GameModle.pathPositionData.get(index))\r\n            let _class: MapItem = tempItem.addComponent(MapItem);\r\n            _class.myNumber = index;\r\n            _class.myType = this.getStationType(index);\r\n            _class.setSprite(this.getSpriteType(index));\r\n            GameModle.mapItem.set(index, _class)\r\n        }\r\n        for (let index = 2; index <= 19; index++) {\r\n            let _node = this.exceptionSprite(index)\r\n            let spriteClass = _node.addComponent(MapSprite)\r\n            spriteClass.mySprite.spriteFrame = AssetMng.data_SprtieAtlas.get(\"Station_Gary_\" + index.toString())\r\n            spriteClass.type = index\r\n            GameModle.mapSprite.set(index, spriteClass)\r\n        }\r\n\r\n        //test\r\n        // cc.find(\"Canvas/2 copy\").addComponent(MapSprite).getAction()\r\n        // console.log(GameModle.pathBezierData);\r\n        // console.log(GameModle.pathPositionData);\r\n    }\r\n    AddBezier(mapNumber: number, pathData: Array<object>, GameModle: GameModle) {\r\n        let Arr: Array<cc.Vec2> = []\r\n        //起點\r\n        // 中間點\r\n        // 再來終點\r\n        //因為資料還是被維持在五號.所以要往回拿資料...太麻煩了ㄅ\r\n        let x = pathData[mapNumber][\"value\"][0];\r\n        let y = pathData[mapNumber][\"value\"][1];\r\n        Arr.push(cc.v2(x, y))\r\n        console.log(cc.v2(x, y));\r\n\r\n        x = pathData[mapNumber][\"motionPath\"][0][0];\r\n        y = pathData[mapNumber][\"motionPath\"][0][1];\r\n        Arr.push(cc.v2(x, y))\r\n        // console.log(cc.v2(x, y));\r\n        // for (let index = 0; index < pathData[mapNumber][\"motionPath\"][0].length; index++) {\r\n        //     // console.log(pathData[mapNumber-1][\"motionPath\"][0]);\r\n        //     // console.log(pathData[mapNumber-1][\"motionPath\"][0].length);\r\n        //     let x: number = pathData[mapNumber][\"motionPath\"][0][index]\r\n        //     index++\r\n        //     let y: number = pathData[mapNumber][\"motionPath\"][0][index]\r\n        //     Arr.push(cc.v2(x, y))\r\n        // }\r\n        //調整位子  有夠麻煩\r\n        // let getPushOne: cc.Vec2 = Arr.splice(1, 1)[0]\r\n        // console.log(getPushOne.x,getPushOne.y);\r\n        // Arr.unshift(getPushOne);\r\n\r\n        //下一個點為終點所以要在這加入\r\n        x = pathData[mapNumber + 1][\"value\"][0];\r\n        y = pathData[mapNumber + 1][\"value\"][1];\r\n        Arr.push(cc.v2(x, y))\r\n        console.log(Arr);\r\n\r\n        GameModle.pathBezierData.set(mapNumber + 1, Arr);\r\n    }\r\n    getSpriteType(_number: number) {\r\n        // console.log(_number);\r\n\r\n        switch (_number) {\r\n            case 0:\r\n                return AssetMng.data_SprtieAtlas.get(\"Station_Start\");\r\n            case 1:\r\n            case 20:\r\n                return AssetMng.data_SprtieAtlas.get(\"Station_WaitRad\");\r\n            case 5:\r\n            case 11:\r\n            case 15:\r\n            case 18:\r\n                return AssetMng.data_SprtieAtlas.get(\"Station_Q&A\");\r\n            default:\r\n                return AssetMng.data_SprtieAtlas.get(\"Station_Normal\");\r\n        }\r\n        // let getType:StationType = _number\r\n    }\r\n    getStationType(_number: number) {\r\n        switch (_number) {\r\n            case 0:\r\n                return StationType.Start\r\n            case 1:\r\n            case 21:\r\n                return StationType.WaitRad\r\n            case 5:\r\n            case 11:\r\n            case 15:\r\n                return StationType.QandA\r\n            default:\r\n                return StationType.Normal\r\n        }\r\n        // let getType:StationType = _number\r\n    }\r\n\r\n    exceptionSprite(_index: number) {\r\n        let isException = false\r\n        this.exceptionArray.forEach(num => {\r\n            if (num == _index) {\r\n                isException = true\r\n                return;\r\n            }\r\n        })\r\n\r\n        return isException ?\r\n            cc.find(_index.toString(), this.content_Station2) :\r\n            cc.find(_index.toString(), this.content_Station)\r\n    }\r\n}"]}