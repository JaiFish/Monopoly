{"version":3,"sources":["assets\\Script\\Class\\Mam\\Panel_Man.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nimport MusciMng from \"../../Data/base/MusciMng\";\r\nimport MyMath from \"../../Data/MyMath\";\r\nimport { Commamnd } from \"../../Enum/Commad\";\r\nimport { GameEvent } from \"../../Enum/GameEvent\";\r\nimport { GameState } from \"../../Enum/GameState\";\r\nimport EventMng from \"../../Event/EventMng\";\r\nimport ManAction from \"./ManAnimation\";\r\n\r\nexport default class Panel_Man extends ManAction {\r\n    protected onLoad(): void {\r\n        this.nMan = cc.find(\"nMan\", this.node);\r\n        this.initEvent(GameEvent.ManGO, this.manGO)\r\n        this.initEvent(GameEvent.ManStop, this.manStop)\r\n        this.initEvent(GameEvent.ManSkip, this.manSkip)\r\n        this.initEvent(GameEvent.SetModel, this.setGameModle)\r\n        this.initEvent(GameEvent.SetManState, this.setManState);\r\n        this.nowStation = 0\r\n        this.node.opacity = 0\r\n        this.isArrival = true\r\n        this.isEnd = false\r\n        this.isWaitSingnalLinght = false\r\n    }\r\n    protected start(): void {\r\n        EventMng.emit(GameEvent.SendModel, GameEvent.SetModel)\r\n\r\n    }\r\n    protected update(dt: number): void {\r\n        if (this.isCanGo) {\r\n\r\n            let x = (dt * this.xSpeed * this.manSpeed) * this.directionX\r\n            let y = (dt * this.ySpeed * this.manSpeed) * this.directionY\r\n\r\n            x = MyMath.add(this.nMan.x, x)\r\n            y = MyMath.add(this.nMan.y, y)\r\n            this.nMan.setPosition(x, y);\r\n            if (this.checkX(x) && this.checkY(y)) {\r\n                this.skipGoPosition()\r\n                this.isArrival = true\r\n                this.stopGo();\r\n                EventMng.emit(GameEvent.GetStation, this.nowStation)\r\n                EventMng.emit(GameEvent.UIGetStation, this.nowStation)\r\n                if (this.nowStation == 8)\r\n                    this.caveException()\r\n                // console.log(this.manState);\r\n                if (this.isEnd) {\r\n                    this.manStop()\r\n                    this.EventEmit(GameEvent.SendCommand, Commamnd.ShowEndGame)\r\n                }\r\n\r\n                if (!this.checkStationStop()) {\r\n                    if (this.manState == GameState.Start || this.manState == GameState.Skip)\r\n                        this.manGO()\r\n                    else\r\n                        this.EventEmit(GameEvent.SendCommand, Commamnd.UpdataUIStart, false)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    manGO() {\r\n        // console.log(\"開始走囉\", this.isCanGo);\r\n        if (this.isWaitSingnalLinght)\r\n            return\r\n        if (this.manState == GameState.ShowMessage) return\r\n        if (this.isArrival) {\r\n            this.setStation();\r\n            this.smoothSpeed();\r\n            this.setNextPosition(this.gameModle.pathPositionData.get(this.nowStation));\r\n            this.isArrival = false;\r\n        }\r\n        if (this.checkSignalLight() && !this.isWaitSingnalLinght) {\r\n            this.EventEmit(GameEvent.SendCommand, Commamnd.WaitSignalLight)\r\n            this.isWaitSingnalLinght = true\r\n            return\r\n        }\r\n        let getID = MusciMng.effectPlay(\"TrainGoing\",true)\r\n        cc.audioEngine.setVolume(getID,1)\r\n        this.setManState(GameState.Start)\r\n        this.startGO();\r\n\r\n        // console.log(\"開始走囉\", this.isCanGo);\r\n    }\r\n    manEndSignalLight() {\r\n        this.isWaitSingnalLinght = false\r\n        this.setManState(GameState.Start)\r\n        this.startGO();\r\n        MusciMng.effectPlay(\"TrainGoing\",true)\r\n    }\r\n    manLineWait() {\r\n        if (this.isWaitSingnalLinght) return\r\n        MusciMng.effectStop(\"TrainGoing\")\r\n        this.setManState(GameState.Wait)\r\n        this.stopGo();\r\n    }\r\n    manWait() {\r\n        if (this.isWaitSingnalLinght) return\r\n        MusciMng.effectStop(\"TrainGoing\")\r\n        this.setManState(GameState.Wait)\r\n    }\r\n    manStop() {\r\n        MusciMng.effectStop(\"TrainGoing\")\r\n        this.setManState(GameState.Stop)\r\n        this.stopGo();\r\n    }\r\n    manSkip() {\r\n        if (this.isWaitSingnalLinght) return\r\n        if (!this.isCanGo) this.startGO();\r\n        this.manSpeed = this.manSkipSeed;\r\n        this.setManState(GameState.Skip)\r\n    }\r\n    setStation(num: number = 1) {\r\n        this.nowStation += num;\r\n        if (this.nowStation > 20) {\r\n            this.nowStation = 0\r\n            this.isEnd = true\r\n        }\r\n    }\r\n\r\n    setNextPosition(_pos: cc.Vec2) {\r\n        let changePosition: cc.Vec3 = this.gameModle.convertOtherNodeSpaceAR(this.gameModle.mapItem.get(this.nowStation).node, this.node);\r\n        // console.log(changePosition);\r\n\r\n        this.targetX = MyMath.round(changePosition.x, 3);\r\n        this.targetY = MyMath.round(changePosition.y, 3);\r\n\r\n        // console.log(this.targetX, this.targetY);\r\n        // console.log(this.nMan.x, this.nMan.y);\r\n\r\n\r\n        this.directionX = this.targetX > this.nMan.x ? 1 : -1\r\n        this.directionY = this.targetY > this.nMan.y ? 1 : -1\r\n    }\r\n    skipGoPosition() {\r\n        this.nMan.setPosition(this.targetX, this.targetY);\r\n    }\r\n\r\n    smoothSpeed(): void {\r\n        let pos = this.gameModle.convertOtherNodeSpaceAR(this.gameModle.mapItem.get(this.nowStation).node, this.node);\r\n        let man = this.nMan.getPosition()\r\n\r\n        //計算兩點之間距離\r\n        let distance = pos.subSelf(cc.v3(man.x, man.y))\r\n\r\n        //計算絕對值\r\n        let absX = Math.abs(distance.x)\r\n        let absY = Math.abs(distance.y)\r\n        // console.log(absX, absY);\r\n\r\n        //開始畢氏定理~~~~\r\n\r\n        //計算向量距離(斜邊) vectorDistance=向量距離\r\n        let vectorDistance = Math.sqrt(Math.pow(absX, 2) + Math.pow(absY, 2))\r\n        // console.log(absX / vectorDistance);\r\n        // console.log(absY / vectorDistance);\r\n        //(向量單邊距離 / 向量距離) * 移動速率\r\n        this.xSpeed = (absX / vectorDistance);\r\n        this.ySpeed = (absY / vectorDistance);\r\n    }\r\n    setManState(_state: GameState) {\r\n        this.manState = _state;\r\n        // switch (_state) {\r\n        //     case GameState.Start:\r\n        //         this.manState = GameState.Start;\r\n        //         break;\r\n        //         case GameState.Wait:\r\n        //             this.manState = GameState.Wait;\r\n        //         break;\r\n        // }\r\n    }\r\n    setManSprite(_sprite: cc.SpriteFrame) {\r\n        this.nMan.getComponent(cc.Sprite).spriteFrame = _sprite\r\n    }\r\n    /**\r\n     * 回到原點\r\n     */\r\n    resetOeg() {\r\n        this.node.opacity = 255\r\n        this.setStation(0);\r\n        this.setNextPosition(this.gameModle.pathPositionData.get(this.nowStation));\r\n        this.skipGoPosition();\r\n        this.manState = GameState.Stop;\r\n        this.manSpeed = this.manDefaultSpeed;\r\n        this.stopGo()\r\n    }\r\n    checkX(x: number): boolean {\r\n        let nowX = MyMath.round(x, 3);\r\n        if (this.directionX > 0)\r\n            return nowX > this.targetX ? true : false\r\n        else\r\n            return nowX < this.targetX ? true : false\r\n    }\r\n    checkY(y: number): boolean {\r\n        let nowY = MyMath.round(y, 3);\r\n        if (this.directionY > 0)\r\n            return nowY > this.targetY ? true : false\r\n        else\r\n            return nowY < this.targetY ? true : false\r\n    }\r\n    checkStationStop(): boolean {\r\n        if (this.nowStation == 5 ||\r\n            this.nowStation == 11 ||\r\n            this.nowStation == 15 ||\r\n            this.nowStation == 1 ||\r\n            this.nowStation == 20 ||\r\n            this.nowStation == 21\r\n        ) {\r\n            this.stopGo()\r\n            this.EventEmit(GameEvent.SendCommand, Commamnd.UpdataUIStart, false)\r\n            this.manState = GameState.Stop\r\n            this.manSpeed = this.manDefaultSpeed;\r\n            switch (this.nowStation) {\r\n                case 5:\r\n                case 11:\r\n                case 15:\r\n                    this.EventEmit(GameEvent.SendCommand, Commamnd.ShowQA)\r\n                    //傳遞訊息開啟QA視窗\r\n                    break;\r\n                case 1:\r\n                case 20:\r\n                    this.EventEmit(GameEvent.SendCommand, Commamnd.ShowVideo)\r\n                    //傳遞Show影片訊息\r\n                    break;\r\n                case 21:\r\n                    this.EventEmit(GameEvent.SendCommand, Commamnd.ShowEndGame)\r\n                    break;\r\n            }\r\n            return true;\r\n        }\r\n        else\r\n            return false;\r\n\r\n    }\r\n    caveException() {\r\n        cc.find(\"Canvas/BG\").setSiblingIndex(this.node.getSiblingIndex() - 1)\r\n    }\r\n    checkSignalLight() {//因為都會先計算下一個路的點，因此都會先+1，為了往回推需不需要停止就要-1\r\n        let tryGet = this.nowStation - 1\r\n        console.log(\"計算數字：\" + tryGet);\r\n        if (this.WaitArray[0] == tryGet) {\r\n            this.WaitArray.shift()\r\n            return true\r\n        }\r\n        else return false\r\n    }\r\n}\r\n\r\n\r\n"]}